---
import Button from "./Button.astro";
---

<div
  class="bg-white fixed top-0 left-0 right-0 z-40 transition-transform duration-300 ease-in-out"
  id="navbar"
>
  <div
    class="flex justify-between items-center px-6 py-5 lg:p-[32px] max-w-[1216px] xl:px-0 mx-auto"
  >
    <!-- Logo Section -->
    <a href={`${import.meta.env.ROOT_FOLDER}`} class="flex gap-2 items-center">
      <img
        src={`${import.meta.env.ICONS_FOLDER}/logo.svg`}
        alt="Logo"
        class="w-8 h-8 lg:w-10 lg:h-10"
      />
      <p class="text-24 font-bold text-black">AKTIV</p>
    </a>

    <!-- Desktop Navigation -->
    <div class="hidden lg:flex gap-32 text-16 font-medium text-gray">
      <a href={`${import.meta.env.ROOT_FOLDER}/view-booking`} class="hover:text-black transition-colors">View My Booking</a>
      <a href="" class="hover:text-black transition-colors">Workshop</a>
      <a href="" class="hover:text-black transition-colors">Community</a>
      <a href="" class="hover:text-black transition-colors">Testimone</a>
    </div>

    <!-- Desktop Contact Button -->
    <div class="hidden lg:block">
      <Button variant="green" size="small" icon="wa.svg" iconAlt="Phone Call">
        Contact CS
      </Button>
    </div>

    <!-- Mobile Hamburger Button -->
    <button
      id="mobile-menu-button"
      class="lg:hidden flex flex-col gap-1 p-2"
      aria-label="Toggle mobile menu"
    >
      <span class="w-6 h-0.5 bg-black transition-all duration-300" id="line1"
      ></span>
      <span class="w-6 h-0.5 bg-black transition-all duration-300" id="line2"
      ></span>
      <span class="w-6 h-0.5 bg-black transition-all duration-300" id="line3"
      ></span>
    </button>
  </div>
</div>

<!-- Mobile Drawer Backdrop -->
<div
  id="drawer-backdrop"
  class="fixed inset-0 z-50 lg:hidden bg-black/40 backdrop-blur-sm opacity-0 transition-opacity duration-300 ease-in-out pointer-events-none"
>
</div>

<!-- Mobile Drawer Content -->
<div
  id="mobile-drawer"
  class="fixed inset-y-0 left-0 z-50 lg:hidden w-72 max-w-[80vw] h-full bg-white shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out"
>
  <!-- Drawer Header -->
  <div class="flex justify-between items-center px-8 py-6">
    <div class="flex gap-3 items-center">
      <img
        src={`${import.meta.env.ICONS_FOLDER}/logo.svg`}
        alt="Logo"
        class="w-7 h-7"
      />
      <p class="text-xl font-bold text-black">AKTIV</p>
    </div>
    <button
      id="close-drawer-button"
      class="p-1.5 hover:bg-gray-50 rounded-lg transition-colors duration-200"
      aria-label="Close menu"
    >
      <svg
        class="w-5 h-5 text-gray-600"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </div>

  <!-- Drawer Navigation -->
  <nav class="px-8 pb-8">
    <div class="flex flex-col space-y-1">
      <a
        href={`${import.meta.env.ROOT_FOLDER}/view-booking`}
        class="text-lg font-medium text-gray-700 hover:text-black hover:bg-gray-50 transition-all duration-200 py-3 px-4 rounded-lg"
      >
        View My Booking
      </a>
      <a
        href=""
        class="text-lg font-medium text-gray-700 hover:text-black hover:bg-gray-50 transition-all duration-200 py-3 px-4 rounded-lg"
      >
        Workshop
      </a>
      <a
        href=""
        class="text-lg font-medium text-gray-700 hover:text-black hover:bg-gray-50 transition-all duration-200 py-3 px-4 rounded-lg"
      >
        Community
      </a>
      <a
        href=""
        class="text-lg font-medium text-gray-700 hover:text-black hover:bg-gray-50 transition-all duration-200 py-3 px-4 rounded-lg"
      >
        Testimone
      </a>
    </div>
  </nav>

  <!-- Drawer Footer -->
  <div class="absolute bottom-8 left-8 right-8">
    <Button
      variant="green"
      size="medium"
      icon="wa.svg"
      iconAlt="Phone Call"
      class="w-full"
    >
      Contact CS
    </Button>
  </div>
</div>

<script>
  // Mobile drawer functionality
  const mobileMenuButton = document.getElementById("mobile-menu-button");
  const closeDrawerButton = document.getElementById("close-drawer-button");
  const drawerBackdrop = document.getElementById("drawer-backdrop");
  const mobileDrawer = document.getElementById("mobile-drawer");
  const line1 = document.getElementById("line1");
  const line2 = document.getElementById("line2");
  const line3 = document.getElementById("line3");

  function openDrawer() {
    mobileDrawer.classList.remove("-translate-x-full");
    drawerBackdrop.classList.remove("opacity-0", "pointer-events-none");
    drawerBackdrop.classList.add("opacity-100", "pointer-events-auto");
    document.body.style.overflow = "hidden";

    // Animate hamburger to X
    line1.style.transform = "rotate(45deg) translate(5px, 5px)";
    line2.style.opacity = "0";
    line3.style.transform = "rotate(-45deg) translate(7px, -6px)";
  }

  function closeDrawer() {
    mobileDrawer.classList.add("-translate-x-full");
    drawerBackdrop.classList.remove("opacity-100", "pointer-events-auto");
    drawerBackdrop.classList.add("opacity-0", "pointer-events-none");
    document.body.style.overflow = "";

    // Reset hamburger animation
    line1.style.transform = "";
    line2.style.opacity = "";
    line3.style.transform = "";
  }

  // Event listeners
  mobileMenuButton?.addEventListener("click", openDrawer);
  closeDrawerButton?.addEventListener("click", closeDrawer);
  drawerBackdrop?.addEventListener("click", closeDrawer);

  // Close drawer on escape key
  document.addEventListener("keydown", (e) => {
    if (
      e.key === "Escape" &&
      !mobileDrawer.classList.contains("-translate-x-full")
    ) {
      closeDrawer();
    }
  });

  // Close drawer when clicking on navigation links
  const drawerLinks = mobileDrawer?.querySelectorAll("nav a");
  drawerLinks?.forEach((link) => {
    link.addEventListener("click", closeDrawer);
  });

  // Navbar scroll behavior
  let lastScrollY = window.scrollY;
  let ticking = false;
  const navbar = document.getElementById("navbar");

  function updateNavbar() {
    const currentScrollY = window.scrollY;

    if (currentScrollY > lastScrollY && currentScrollY > 50) {
      // Scrolling down - hide navbar
      navbar?.classList.add("-translate-y-full");
    } else {
      // Scrolling up - show navbar
      navbar?.classList.remove("-translate-y-full");
    }

    lastScrollY = currentScrollY;
    ticking = false;
  }

  function requestTick() {
    if (!ticking) {
      requestAnimationFrame(updateNavbar);
      ticking = true;
    }
  }

  // Add scroll event listener
  window.addEventListener("scroll", requestTick, { passive: true });
</script>
